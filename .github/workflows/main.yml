      - name: Run refresh script (debug folders)
        env:
          TENANT_ID: ${{ secrets.TENANT_ID }}
          CLIENT_ID: ${{ secrets.CLIENT_ID }}
          CLIENT_SECRET: ${{ secrets.CLIENT_SECRET }}
        run: |
          python - <<'PYCODE'
          import os, requests

          TENANT_ID = os.environ["TENANT_ID"]
          CLIENT_ID = os.environ["CLIENT_ID"]
          CLIENT_SECRET = os.environ["CLIENT_SECRET"]
          USER_EMAIL = "tiennm@tuanvietc5.id.vn"

          # ðŸ” Láº¥y token
          token_url = f"https://login.microsoftonline.com/{TENANT_ID}/oauth2/v2.0/token"
          token_data = {
              "grant_type": "client_credentials",
              "client_id": CLIENT_ID,
              "client_secret": CLIENT_SECRET,
              "scope": "https://graph.microsoft.com/.default"
          }
          token = requests.post(token_url, data=token_data).json().get("access_token")
          headers = {"Authorization": f"Bearer {token}"}

          # ðŸ“ Láº¥y Drive ID
          drive_resp = requests.get(f"https://graph.microsoft.com/v1.0/users/{USER_EMAIL}/drives", headers=headers)
          drive_data = drive_resp.json()
          DRIVE_ID = drive_data["value"][0]["id"]
          print(f"ðŸ“‚ Drive ID: {DRIVE_ID}\n")

          # ðŸ“ In danh sÃ¡ch thÆ° má»¥c gá»‘c
          print("ðŸ“„ Danh sÃ¡ch thÆ° má»¥c trong root:")
          root_resp = requests.get(f"https://graph.microsoft.com/v1.0/drives/{DRIVE_ID}/root/children", headers=headers)
          for item in root_resp.json().get("value", []):
              print(" -", item["name"])

          # ðŸ“ In thá»­ ná»™i dung thÆ° má»¥c "1.Job"
          print("\nðŸ“ Ná»™i dung trong /1.Job:")
          job_resp = requests.get(f"https://graph.microsoft.com/v1.0/drives/{DRIVE_ID}/root:/1.Job:/children", headers=headers)
          print(job_resp.json())
          PYCODE
